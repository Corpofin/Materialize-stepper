/**
 * Materialize Stepper - A little plugin that implements a stepper to Materializecss framework.
 * @version v3.0.0
 * @author Igor Marcossi (Kinark) <igormarcossi@gmail.com>.
 * @link https://github.com/Kinark/Materialize-stepper
 * 
 * Licensed under the MIT License (https://github.com/Kinark/Materialize-stepper/blob/master/LICENSE).
 */

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MStepper=function(){function p(e){var v=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,p),_defineProperty(this,"smartListenerUnbind",function(e,t,n){var i=v.listenerStore,r=i.indexOf({el:e,event:t,fn:n});e.removeEventListener(t,n),i.splice(r,1)}),_defineProperty(this,"smartListenerBind",function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],s=v.listenerStore,o={el:e,event:t,fn:n};if(i)for(var a=0;a<s.length;a++){var l=s[a];l.event===t&&l.el.isSameNode(e)&&l.el.removeEventListener(l.event,l.fn),r&&l.fn()}else{var p=s.indexOf(o);if(-1!==c){var c=s[p];c.el.removeEventListener(c.event,c.fn),r&&c[p].fn()}}e.addEventListener(t,n),s.push(o)}),_defineProperty(this,"openAction",function(e){e.classList.remove("done");var n=e.getElementsByClassName("step-content")[0],t="".concat(p.getUnknownHeight(n),"px"),i=function e(t){"height"===t.propertyName&&(v.smartListenerUnbind(n,"transitionend",e),p.removeMultipleProperties(n,"visibility overflow height display"))};return requestAnimationFrame(function(){n.style.overflow="hidden",n.style.visibility="unset",n.style.display="block",requestAnimationFrame(function(){v.smartListenerBind(n,"transitionend",i,!0),n.style.height=t,e.classList.add("active")})}),e}),_defineProperty(this,"closeAction",function(e){var n=e.getElementsByClassName("step-content")[0],t="".concat(n.offsetHeight,"px"),i=function e(t){"height"===t.propertyName&&(v.smartListenerUnbind(n,"transitionend",e),p.removeMultipleProperties(n,"visibility overflow height display"))};return requestAnimationFrame(function(){n.style.overflow="hidden",n.style.visibility="unset",n.style.display="block",n.style.height=t,requestAnimationFrame(function(){v.smartListenerBind(n,"transitionend",i,!0),n.style.height="0",e.classList.remove("active")})}),e}),_defineProperty(this,"activateStepper",function(){var e=v.wrapWithForm,t=v.getSteps,n=v.options,i=v.stepper,r=v.classes,s=v.nextStep,o=v.prevStep,a=v.openAction,l=p.addEventListenerByClass;e(),a(t().steps[n.firstActive]),l(i,r.NEXT,"click",s),l(i,r.PREV,"click",o)}),_defineProperty(this,"nextStep",function(){var e=v.getSteps(),t=e.active;v.closeAction(t.step),v.openAction(e.steps[t.index+1])}),_defineProperty(this,"prevStep",function(){var e=v.getSteps().active;v.closeAction(e.step),v.openAction(v.getSteps().steps[e.index+-1])}),_defineProperty(this,"getSteps",function(){for(var e,t,n=v.stepper.querySelectorAll("li"),i=0;i<n.length;i++)n[i].classList.contains("active")&&(e=n[i],t=i);return{steps:n,active:{step:e,index:t}}}),_defineProperty(this,"wrapWithForm",function(){var e=v.stepper;if(!parentsUntil(e,"form").length&&v.options.autoFormCreation){var t=e.dataset||{},n=t||"GET",i=t||"?",r=document.createElement("form");r.method=n,r.action=i}}),this.stepper=e,this.options={firstActive:t.firstActive||0,linearStepsNavigation:t.linearStepsNavigation||!0,autoFocusInput:t.autoFocusInput||!0,showFeedbackLoader:t.showFeedbackLoader||!0,autoFormCreation:t.autoFormCreation||!0},this.classes={NEXT:"next-step",PREV:"previous-step",ACTIVE:"active",DONE:"done",FB:"feedbacking"},this.events={STPCHG:"stepChange",NEXT:"nextStep",PREV:"prevStep",STEP:function(e){return"step".concat(e)}},this.listenerStore=[],this.activateStepper()}return _createClass(p,null,[{key:"addEventListenerByClass",value:function(e,t,n,i){for(var r=e.getElementsByClassName(t),s=0,o=r.length;s<o;s++)r[s].addEventListener(n,i,!1)}},{key:"removeMultipleProperties",value:function(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)e.style.removeProperty(n[i])}},{key:"getUnknownHeight",value:function(e){var t=e.cloneNode(!0);t.style.position="fixed",t.style.display="block",t.style.top="-999999px",t.style.left="-999999px",t.style.height="auto",t.style.opacity="0",t.style.zIndex="-999999",t.style.pointerEvents="none";var n=e.parentNode.appendChild(t),i=n.offsetHeight;return e.parentNode.removeChild(n),i}}]),p}();function parentsUntil(e,t,n){var i=[],r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(e=e.parentElement;e&&!r.call(e,t);)n?r.call(e,n)&&i.push(e):i.push(e),e=e.parentElement;return i}